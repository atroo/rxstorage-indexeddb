{"version":3,"sources":["../../src/db-meta-helpers.ts"],"names":["openConnection","getDbMeta","upgrade","db","createObjectStore","keyPath","blocking","close"],"mappings":";;;;;;;;;;;;;AAAA;;AAGA,IAAIA,cAAJ;;AAEO,IAAMC,SAAS;AAAA,2FAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACnBD,cADmB;AAAA;AAAA;AAAA;;AAAA,6CAEdA,cAFc;;AAAA;AAAA;AAAA,mBAKN,iBAAgB,yBAAhB,EAA2C,CAA3C,EAA8C;AAC7DE,cAAAA,OAAO,EAAE,iBAACC,EAAD,EAAQ;AACf;AACAA,gBAAAA,EAAE,CAACC,iBAAH,CAAqB,YAArB,EAAmC;AACjCC,kBAAAA,OAAO,EAAE;AADwB,iBAAnC;AAIAF,gBAAAA,EAAE,CAACC,iBAAH,CAAqB,aAArB,EAAoC;AAClCC,kBAAAA,OAAO,EAAE,CAAC,QAAD,EAAW,YAAX,EAAyB,MAAzB;AADyB,iBAApC;AAGD,eAV4D;AAW7DC,cAAAA,QAAQ,EAAE,oBAAM;AACdH,gBAAAA,EAAE,CAACI,KAAH;AACD;AAb4D,aAA9C,CALM;;AAAA;AAKjBJ,YAAAA,EALiB;AAqBvBH,YAAAA,cAAc,GAAGG,EAAjB;AArBuB,6CAuBhBH,cAvBgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAATC,SAAS;AAAA;AAAA;AAAA,GAAf","sourcesContent":["import { IDBPDatabase, openDB } from \"idb\";\r\nimport { IMetaDB } from \"./types/browser-storeage-state\";\r\n\r\nlet openConnection: IDBPDatabase<IMetaDB>;\r\n\r\nexport const getDbMeta = async () => {\r\n  if (openConnection) {\r\n    return openConnection;\r\n  }\r\n\r\n  const db = await openDB<IMetaDB>(\"rx-browser-storage-meta\", 1, {\r\n    upgrade: (db) => {\r\n      // store version, collections\r\n      db.createObjectStore(\"dbMetaData\", {\r\n        keyPath: \"dbName\",\r\n      });\r\n\r\n      db.createObjectStore(\"indexedCols\", {\r\n        keyPath: [\"dbName\", \"collection\", \"name\"],\r\n      });\r\n    },\r\n    blocking: () => {\r\n      db.close();\r\n    },\r\n  });\r\n\r\n  openConnection = db;\r\n\r\n  return openConnection;\r\n};\r\n"],"file":"db-meta-helpers.js"}