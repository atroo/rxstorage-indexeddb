{"version":3,"sources":["../../src/db-meta-helpers.ts"],"names":["openConnection","getDbMeta","upgrade","db","dbMetaDataStore","createObjectStore","keyPath","createIndex","indexedColsStore","blocking","close"],"mappings":";;;;;;;;;;;;;AAAA;;AAGA,IAAIA,cAAJ;;AAEO,IAAMC,SAAS;AAAA,2FAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACnBD,cADmB;AAAA;AAAA;AAAA;;AAAA,6CAEdA,cAFc;;AAAA;AAAA;AAAA,mBAKN,iBAAgB,yBAAhB,EAA2C,CAA3C,EAA8C;AAC7DE,cAAAA,OAAO,EAAE,iBAACC,EAAD,EAAQ;AACf;AACA,oBAAMC,eAAe,GAAGD,EAAE,CAACE,iBAAH,CAAqB,YAArB,EAAmC;AACzDC,kBAAAA,OAAO,EAAE;AADgD,iBAAnC,CAAxB;AAIAF,gBAAAA,eAAe,CAACG,WAAhB,CAA4B,QAA5B,EAAsC,QAAtC;AAEA,oBAAMC,gBAAgB,GAAGL,EAAE,CAACE,iBAAH,CAAqB,aAArB,EAAoC;AAC3DC,kBAAAA,OAAO,EAAE;AADkD,iBAApC,CAAzB;AAIAE,gBAAAA,gBAAgB,CAACD,WAAjB,CAA6B,YAA7B,EAA2C,YAA3C;AACD,eAd4D;AAe7DE,cAAAA,QAAQ,EAAE,oBAAM;AACdN,gBAAAA,EAAE,CAACO,KAAH;AACD;AAjB4D,aAA9C,CALM;;AAAA;AAKjBP,YAAAA,EALiB;AAyBvBH,YAAAA,cAAc,GAAGG,EAAjB;AAzBuB,6CA2BhBH,cA3BgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAATC,SAAS;AAAA;AAAA;AAAA,GAAf","sourcesContent":["import { IDBPDatabase, openDB } from \"idb\";\r\nimport { IMetaDB } from \"./types/browser-storeage-state\";\r\n\r\nlet openConnection: IDBPDatabase<IMetaDB>;\r\n\r\nexport const getDbMeta = async () => {\r\n  if (openConnection) {\r\n    return openConnection;\r\n  }\r\n\r\n  const db = await openDB<IMetaDB>(\"rx-browser-storage-meta\", 1, {\r\n    upgrade: (db) => {\r\n      // store version, collections\r\n      const dbMetaDataStore = db.createObjectStore(\"dbMetaData\", {\r\n        keyPath: \"dbName\",\r\n      });\r\n\r\n      dbMetaDataStore.createIndex(\"dbName\", \"dbName\");\r\n\r\n      const indexedColsStore = db.createObjectStore(\"indexedCols\", {\r\n        keyPath: \"collection\",\r\n      });\r\n\r\n      indexedColsStore.createIndex(\"collection\", \"collection\");\r\n    },\r\n    blocking: () => {\r\n      db.close();\r\n    },\r\n  });\r\n\r\n  openConnection = db;\r\n\r\n  return openConnection;\r\n};\r\n"],"file":"db-meta-helpers.js"}